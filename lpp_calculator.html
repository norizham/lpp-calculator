<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LPP Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 20px auto;
      padding: 10px;
      line-height: 1.4;
    }
    h1, h2, h3 {
      margin-bottom: 0.3em;
    }
    fieldset {
      margin-bottom: 15px;
      padding: 10px 15px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    legend {
      font-weight: bold;
      padding: 0 4px;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 120px;
      gap: 6px 10px;
      align-items: center;
      margin-bottom: 5px;
    }
    label {
      font-size: 0.95em;
    }
    input[type="number"] {
      width: 100%;
      box-sizing: border-box;
      padding: 4px;
    }
    .buttons {
      margin: 15px 0;
    }
    button {
      padding: 8px 16px;
      margin-right: 10px;
      cursor: pointer;
    }
    .results {
      background: #f5f5f5;
      padding: 10px 15px;
      border-radius: 6px;
      border: 1px solid #ddd;
    }
    .results p {
      margin: 4px 0;
    }
    .highlight {
      font-weight: bold;
      font-size: 1.1em;
      margin-top: 8px;
    }
  </style>
</head>
<body>
  <h1>LPP Calculator</h1>
  <p>Masukkan markah (0–100) untuk setiap item. Kalkulasi mengikuti struktur Excel: X1 (maks 60), X2 (maks 40), Komponen kuantitatif 42%, M3–M5 28%, Y 20%, Z/CPD 10%.</p>

  <!-- X1: Komponen kuantitatif (42%) – Total X1 (60%) -->
  <fieldset>
    <legend>X1 – Komponen kuantitatif (42%) – maks 60</legend>
    <div class="grid">
      <label for="x1_q1q2">X1: M1 Q1 &amp; Q2 (C4)</label>
      <input id="x1_q1q2" type="number" min="0" max="100" step="0.01" value="0">

      <label for="x1_q1q4">X1: M1 Q1–Q4 (C5)</label>
      <input id="x1_q1q4" type="number" min="0" max="100" step="0.01" value="0">

      <label for="x1_geran">X1: M1 Geran (C6)</label>
      <input id="x1_geran" type="number" min="0" max="100" step="0.01" value="0">

      <label for="x1_penyeliaan">X1: M2 Penyeliaan (C7)</label>
      <input id="x1_penyeliaan" type="number" min="0" max="100" step="0.01" value="0">

      <label for="x1_pengajaran">X1: M2 Pengajaran (C8)</label>
      <input id="x1_pengajaran" type="number" min="0" max="100" step="0.01" value="0">
    </div>
    <p><em>Formula Excel: X1 = (C4+C5+C6+C7+C8)/500 × 60.</em></p>
  </fieldset>

  <!-- X2: Kualiti penerbitan – Total X2 (40%) -->
  <fieldset>
    <legend>X2 – Kualiti Penerbitan – maks 40 (ikut formula Excel)</legend>
    <div class="grid">
      <label for="x2_pub1">X2: Kualiti Penerbitan 1 (C10)</label>
      <input id="x2_pub1" type="number" min="0" max="100" step="0.01" value="0">

      <label for="x2_pub2">X2: Kualiti Penerbitan 2 (C11)</label>
      <input id="x2_pub2" type="number" min="0" max="100" step="0.01" value="0">

      <label for="x2_geran">X2: Geran (Kualiti) (C12)</label>
      <input id="x2_geran" type="number" min="0" max="100" step="0.01" value="0">
    </div>
    <p><em>Formula Excel: X2 = ((((C10+C11)/200)+(C12/100))/2) × 40.</em></p>
  </fieldset>

  <!-- Komponen kualitatif (28%) – M3, M4, M5 -->
  <fieldset>
    <legend>M3, M4, M5 – Komponen kualitatif (28%) – maks 28</legend>
    <div class="grid">
      <label for="m3">M3 (Kepimpinan Akademik)</label>
      <input id="m3" type="number" min="0" max="100" step="0.01" value="0">

      <label for="m4">M4 (Perundingan)</label>
      <input id="m4" type="number" min="0" max="100" step="0.01" value="0">

      <label for="m5">M5 (Khidmat Universiti)</label>
      <input id="m5" type="number" min="0" max="100" step="0.01" value="0">
    </div>
    <p><em>Ambil <strong>dua markah terbaik</strong> daripada tiga, purata → skala ke 28.</em></p>
  </fieldset>

  <!-- Y components (each 10%) -->
  <fieldset>
    <legend>Y (20%) – Hasil kerja &amp; naratif impak</legend>
    <div class="grid">
      <label for="y1">Y1 (SSR, SAR, Semakan Kurikulum, Audit)</label>
      <input id="y1" type="number" min="0" max="100" step="0.01" value="0">

      <label for="y2">Y2 (Naratif Impak)</label>
      <input id="y2" type="number" min="0" max="100" step="0.01" value="0">
    </div>
  </fieldset>

  <!-- CPD (10%) -->
  <fieldset>
    <legend>Z – CPD (maks 10)</legend>
    <div class="grid">
      <label for="cpd">CPD</label>
      <input id="cpd" type="number" min="0" max="100" step="0.01" value="0">
    </div>
  </fieldset>

  <!-- Buttons -->
  <div class="buttons">
    <button type="button" onclick="calculateLPP()">Calculate</button>
    <button type="button" onclick="resetForm()">Clear Results</button>
    <button type="button" onclick="resetToZero()">Reset All to Zero</button>
  </div>

  <!-- Results -->
  <div class="results" id="results">
    <h3>Results</h3>
    <p id="x1Result"></p>
    <p id="x2Result"></p>
    <p id="comp42Result"></p>
    <p id="m3m4m5Result"></p>
    <p id="totalXResult"></p>
    <p id="y1y2Result"></p>
    <p id="cpdResult"></p>
    <p class="highlight" id="finalResult"></p>
  </div>

  <script>
    // Read value, clamp 0–100, and update field
    function val(id) {
      const input = document.getElementById(id);
      let v = parseFloat(input.value);

      if (isNaN(v)) v = 0;
      if (v < 0) v = 0;
      if (v > 100) v = 100;

      input.value = v;
      return v;
    }

    function calculateLPP() {
      const r = (x) => x.toFixed(2);

      // ---------------- X1: EXACT Excel logic ----------------
      const C4 = val('x1_q1q2');
      const C5 = val('x1_q1q4');
      const C6 = val('x1_geran');
      const C7 = val('x1_penyeliaan');
      const C8 = val('x1_pengajaran');

      const sumX1 = C4 + C5 + C6 + C7 + C8;
      const x1Raw = (sumX1 / 500) * 60; // 0–60
      const x1AvgDisplay = sumX1 / 5;

      // ---------------- X2: EXACT Excel logic ----------------
      const C10 = val('x2_pub1');
      const C11 = val('x2_pub2');
      const C12 = val('x2_geran');

      const x2Raw = ((((C10 + C11) / 200) + (C12 / 100)) / 2) * 40;

      // Komponen kuantitatif (42%)
      const comp42 = ((x1Raw + x2Raw) / 100) * 42;

      // ---------------- M3, M4, M5 → BEST 2 of 3 ----------------
      let m3m4m5Values = [val('m3'), val('m4'), val('m5')];
      m3m4m5Values.sort((a, b) => b - a);
      const mBestAvg = (m3m4m5Values[0] + m3m4m5Values[1]) / 2;
      const m3m4m5Score = (mBestAvg / 100) * 28;

      // TOTAL X (70%)
      const totalX = comp42 + m3m4m5Score;

      // Y1, Y2
      const yTotal = (val('y1') / 100) * 10 + (val('y2') / 100) * 10;

      // CPD
      const cpdScore = (val('cpd') / 100) * 10;

      // Final total
      const finalTotal = totalX + yTotal + cpdScore;

      // Display
      document.getElementById('x1Result').textContent =
        `X1 = ${r(x1Raw)} / 60 (purata item = ${r(x1AvgDisplay)})`;

      document.getElementById('x2Result').textContent =
        `X2 = ${r(x2Raw)} / 40`;

      document.getElementById('comp42Result').textContent =
        `Komponen kuantitatif (42%) = ${r(comp42)} / 42`;

      document.getElementById('m3m4m5Result').textContent =
        `M3/M4/M5 (2 terbaik) = ${r(m3m4m5Score)} / 28`;

      document.getElementById('totalXResult').textContent =
        `Jumlah X (70%) = ${r(totalX)} / 70`;

      document.getElementById('y1y2Result').textContent =
        `Y1 + Y2 = ${r(yTotal)} / 20`;

      document.getElementById('cpdResult').textContent =
        `CPD = ${r(cpdScore)} / 10`;

      document.getElementById('finalResult').textContent =
        `FINAL LPP SCORE = ${r(finalTotal)} / 100`;
    }

    // Clear only output
    function resetForm() {
      document.getElementById('results').querySelectorAll('p').forEach(p => p.textContent = '');
    }

    // Reset all inputs to zero
    function resetToZero() {
      const inputs = document.querySelectorAll('input[type="number"]');
      inputs.forEach(i => i.value = '0');
      resetForm();
      calculateLPP();
    }
  </script>
</body>
</html>