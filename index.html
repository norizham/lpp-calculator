<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LPP Calculator</title>

  <style>
    * { box-sizing: border-box; }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f2f4f8;
      color: #222;
    }

    .page {
      max-width: 1300px;
      margin: 20px auto;
      padding: 0 15px 30px;
    }

    .container {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 25px;
    }

    .left-column { flex: 1.3; }
    .right-column { flex: 1.7; text-align: right; }

    .card {
      background: #ffffff;
      border-radius: 10px;
      padding: 18px 20px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }

    h1 {
      margin-top: 0;
      font-size: 1.6em;
      margin-bottom: 6px;
    }

    .intro {
      font-size: 0.9em;
      color: #4b5563;
      margin-bottom: 10px;
    }

    fieldset {
      margin-bottom: 15px;
      padding: 10px 15px;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
      background: #fff;
      border-left: 4px solid #2563eb;
    }

    legend {
      font-weight: bold;
      font-size: 0.95em;
      text-transform: uppercase;
      color: #111827;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 120px;
      gap: 6px 10px;
      align-items: center;
    }

    label { font-size: 0.95em; }

    input[type="number"] {
      width: 100%;
      padding: 4px;
      border-radius: 4px;
      border: 1px solid #bbb;
      font-size: 0.9em;
    }

    input[type="number"].error {
      border-color: #dc2626;
      background: #fef2f2;
    }

    .section-subtotal {
      font-weight: bold;
      margin-top: 6px;
      font-size: 0.95em;
      color: #1f2937;
      text-align: right;
    }

    .section-subtotal span.value { color: #2563eb; }

    .final-score-box {
      background:#eef2ff;
      border:1px solid #c7d2fe;
      padding:10px 15px;
      border-radius:6px;
      margin-top:15px;
      margin-bottom:15px;
      font-size:1.05em;
      font-weight:bold;
      color:#1e3a8a;
    }

    .buttons { margin: 15px 0; }

    button {
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 4px;
      border: 1px solid #1f6feb;
      background: #2563eb;
      color: #fff;
      font-size: 0.95em;
      margin-right: 10px;
      margin-bottom: 6px;
    }

    button:nth-child(2) { background:#fff; color:#2563eb; }
    button:nth-child(3) { background:#10b981; border-color:#059669; }
    button:nth-child(4) { background:#f97316; border-color:#ea580c; }

    .results {
      background:#f9fafb;
      padding:10px 15px;
      border-radius:6px;
      border:1px solid #e5e7eb;
      margin-top:10px;
      font-size:0.95em;
    }

    .results p { margin:4px 0; }

    .right-column img {
      width: 100%;
      height: auto;
      margin-bottom: 25px;
      border-radius:8px;
      padding:6px;
      background:#fff;
      box-shadow:0 3px 12px rgba(0,0,0,0.12);
    }

    .right-column img.logo {
      width:60%;
      max-width:220px;
      margin-bottom:20px;
    }

    .right-column h3 {
      margin:0 0 6px;
      font-size:0.95em;
      color:#111827;
    }

    @media (max-width:900px) {
      .container { flex-direction: column; }
      .right-column, .right-column h3 { text-align:center; }
    }

    .disclaimer {
      text-align:center;
      margin-top:25px;
      color:#6b7280;
      font-size:0.8em;
    }
  </style>
</head>

<body>

<div class="page">

  <div class="container">

    <!-- LEFT PANEL -->
    <div class="left-column">
      <div class="card">

        <h1>LPP Calculator</h1>
        <p>Please enter scores in the range of 0-100 (for X and M) and 0-10 (for Y and CPD).</p>

        <ul class="intro">
          <li><strong>X1</strong>: M1 Quantity</li>
          <li><strong>X2</strong>: M1 Quality</li>
          <li><strong>M3, M4 & M5</strong>: Leadership, consultancy, service (best of 2)</li>
          <li><strong>Y</strong>: Work output and impact (0-10 each, total 20)</li>
          <li><strong>Z</strong>: CPD (0-10)</li>
        </ul>

        <!-- X1 -->
        <fieldset>
          <legend>X1 - M1 & M2 Quantity ( /60)</legend>
          <div class="grid">
            <label>M1 Publication Q1 / Q2 (0-100)</label>
            <input id="x1_q1q2" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">

            <label>M1 Publication Q1 / Q4 (0-100)</label>
            <input id="x1_q1q4" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">

            <label>Research Grants (0-100)</label>
            <input id="x1_geran" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">

            <label>Supervision (0-100)</label>
            <input id="x1_penyeliaan" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">

            <label>Teaching (0-100)</label>
            <input id="x1_pengajaran" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">
          </div>

          <p class="section-subtotal" id="x1Subtotal">
            X1 subtotal: <span class="value">0.00</span> / 60
          </p>
        </fieldset>

        <!-- X2 -->
        <fieldset>
          <legend>X2 - M1 Quality ( /40)</legend>
          <div class="grid">
            <label> M1 Publication Quality Q1 / Q2 (0-100)</label>
            <input id="x2_pub1" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">

            <label>M1 Publication Quality Q1 / Q4 (0-100)</label>
            <input id="x2_pub2" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">

            <label>Grant Quality (0-100)</label>
            <input id="x2_geran" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">
          </div>

          <p class="section-subtotal" id="x2Subtotal">
            X2 subtotal: <span class="value">0.00</span> / 40
          </p>
        </fieldset>

        <!-- M3-M5 -->
        <fieldset>
          <legend>M3, M4, M5 - Quantity ( /28)</legend>
          <div class="grid">
            <label>M3 Leadership (0-100)</label>
            <input id="m3" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">

            <label>M4 Consultancy (0-100)</label>
            <input id="m4" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">

            <label>M5 Service (0-100)</label>
            <input id="m5" type="number" min="0" max="100" value="0"
                   title="Enter a value between 0 and 100" oninput="calculateLPP()">
          </div>

          <p class="section-subtotal" id="mSubtotal">
            M3-M5 subtotal (best 2): <span class="value">0.00</span> / 28
          </p>
        </fieldset>

        <!-- Y -->
        <fieldset>
          <legend>Y - Outcome & Narrative ( /20)</legend>
          <div class="grid">
            <label>Y1 Output (0-10)</label>
            <input id="y1" type="number" min="0" max="10" value="0"
                   title="Enter a value between 0 and 10" oninput="calculateLPP()">

            <label>Y2 Impact (0-10)</label>
            <input id="y2" type="number" min="0" max="10" value="0"
                   title="Enter a value between 0 and 10" oninput="calculateLPP()">
          </div>

          <p class="section-subtotal" id="ySubtotal">
            Y subtotal: <span class="value">0.00</span> / 20
          </p>
        </fieldset>

        <!-- CPD -->
        <fieldset>
          <legend>Z - CPD ( /10)</legend>
          <div class="grid">
            <label>CPD Score (0-10)</label>
            <input id="cpd" type="number" min="0" max="10" value="0"
                   title="Enter a value between 0 and 10" oninput="calculateLPP()">
          </div>

          <p class="section-subtotal" id="cpdSubtotal">
            CPD subtotal: <span class="value">0.00</span> / 10
          </p>
        </fieldset>

        <!-- FINAL SCORE BELOW Z -->
        <div class="final-score-box">
          <p id="finalScoreTop">FINAL LPP SCORE: 0.00 / 100</p>
        </div>

        <!-- Buttons -->
        <div class="buttons">
          <button onclick="calculateLPP()">Calculate</button>
          <button onclick="resetForm()">Clear outputs</button>
          <button onclick="resetToZero()">Reset inputs to zero</button>
          <button onclick="setAllToMax()">Set all inputs to max</button>
        </div>

        <!-- Detailed Results -->
        <div class="results" id="results">
          <h3>Detailed Results</h3>
          <p id="x1Result"></p>
          <p id="x2Result"></p>
          <p id="comp42Result"></p>
          <p id="m3m4m5Result"></p>
          <p id="totalXResult"></p>
          <p id="y1y2Result"></p>
          <p id="cpdResult"></p>
          <p id="breakdownResult"></p>
          <p id="finalResult"></p>
        </div>

      </div>

      <!-- Disclaimer -->
      <p class="disclaimer">
        Disclaimer: This calculator is provided as-is. Use at your own risk.
      </p>

    </div>

    <!-- RIGHT IMAGES -->
    <div class="right-column">
      <img src="logo.png" class="logo" alt="Logo">

      <h3>Publication Marks</h3>
      <img src="pub_table.png" class="table-img" alt="Publication Table">
    </div>

  </div>
</div>

<script>
  // Clamp values: 0-100 for most, 0-10 for Y1, Y2, CPD
  function val(id) {
    var el = document.getElementById(id);
    var v = parseFloat(el.value);

    // Y1, Y2, CPD use 0-10; others use 0-100
    var maxVal = (id === 'y1' || id === 'y2' || id === 'cpd') ? 10 : 100;

    var outOfRange = false;

    if (isNaN(v)) v = 0;
    if (v < 0) { v = 0; outOfRange = true; }
    if (v > maxVal) { v = maxVal; outOfRange = true; }

    if (outOfRange) el.classList.add('error');
    else el.classList.remove('error');

    el.value = v;
    return v;
  }

  function calculateLPP() {
    var r = function(x) { return x.toFixed(2); };

    // X1
    var C4 = val('x1_q1q2');
    var C5 = val('x1_q1q4');
    var C6 = val('x1_geran');
    var C7 = val('x1_penyeliaan');
    var C8 = val('x1_pengajaran');

    var sumX1 = C4 + C5 + C6 + C7 + C8;
    var x1Raw = (sumX1 / 500) * 60;
    var x1Avg = sumX1 / 5;

    document.getElementById('x1Subtotal').innerHTML =
      'X1 subtotal: <span class="value">' + r(x1Raw) + '</span> / 60';

    // X2
    var C10 = val('x2_pub1');
    var C11 = val('x2_pub2');
    var C12 = val('x2_geran');

    var x2Raw = ((((C10 + C11) / 200) + (C12 / 100)) / 2) * 40;

    document.getElementById('x2Subtotal').innerHTML =
      'X2 subtotal: <span class="value">' + r(x2Raw) + '</span> / 40';

    // Quantitative component (42%)
    var comp42 = ((x1Raw + x2Raw) / 100) * 42;

    // M3-M5 best 2 of 3
    var arr = [val('m3'), val('m4'), val('m5')].sort(function(a,b){return b-a;});
    var mBestAvg = (arr[0] + arr[1]) / 2;
    var mScore = (mBestAvg / 100) * 28;

    document.getElementById('mSubtotal').innerHTML =
      'M3-M5 subtotal (best 2): <span class="value">' + r(mScore) + '</span> / 28';

    var totalX = comp42 + mScore; // up to 70

    // Y: each 0-10, total 0-20
    var y1v = val('y1');
    var y2v = val('y2');
    var yTotal = y1v + y2v;

    document.getElementById('ySubtotal').innerHTML =
      'Y subtotal: <span class="value">' + r(yTotal) + '</span> / 20';

    // CPD: 0-10
    var cpdScore = val('cpd');

    document.getElementById('cpdSubtotal').innerHTML =
      'CPD subtotal: <span class="value">' + r(cpdScore) + '</span> / 10';

    // FINAL TOTAL
    var finalTotal = totalX + yTotal + cpdScore;

    // Top final score
    document.getElementById('finalScoreTop').textContent =
      'FINAL LPP SCORE: ' + r(finalTotal) + ' / 100';

    // Detailed panel
    document.getElementById('x1Result').textContent =
      'X1 = ' + r(x1Raw) + ' / 60 (avg input = ' + r(x1Avg) + ')';

    document.getElementById('x2Result').textContent =
      'X2 = ' + r(x2Raw) + ' / 40';

    document.getElementById('comp42Result').textContent =
      'Quantitative Component (42%) = ' + r(comp42) + ' / 42';

    document.getElementById('m3m4m5Result').textContent =
      'M3-M5 (best 2 of 3) = ' + r(mScore) + ' / 28';

    document.getElementById('totalXResult').textContent =
      'Total X = ' + r(totalX) + ' / 70';

    document.getElementById('y1y2Result').textContent =
      'Y total = ' + r(yTotal) + ' / 20';

    document.getElementById('cpdResult').textContent =
      'CPD = ' + r(cpdScore) + ' / 10';

    document.getElementById('breakdownResult').textContent =
      'Contribution: X = ' + r(totalX) +
      ', Y = ' + r(yTotal) +
      ', Z = ' + r(cpdScore);

    document.getElementById('finalResult').textContent =
      'FINAL LPP SCORE = ' + r(finalTotal) + ' / 100';
  }

  function resetForm() {
    var ps = document.querySelectorAll('#results p');
    ps.forEach(function(p){ p.textContent = ''; });

    document.getElementById('finalScoreTop').textContent =
      'FINAL LPP SCORE: 0.00 / 100';

    document.getElementById('x1Subtotal').innerHTML =
      'X1 subtotal: <span class="value">0.00</span> / 60';
    document.getElementById('x2Subtotal').innerHTML =
      'X2 subtotal: <span class="value">0.00</span> / 40';
    document.getElementById('mSubtotal').innerHTML =
      'M3-M5 subtotal (best 2): <span class="value">0.00</span> / 28';
    document.getElementById('ySubtotal').innerHTML =
      'Y subtotal: <span class="value">0.00</span> / 20';
    document.getElementById('cpdSubtotal').innerHTML =
      'CPD subtotal: <span class="value">0.00</span> / 10';
  }

  function resetToZero() {
    var inputs = document.querySelectorAll('input[type="number"]');
    inputs.forEach(function(i){
      i.value = 0;
      i.classList.remove('error');
    });
    resetForm();
    calculateLPP();
  }

  function setAllToMax() {
    var inputs = document.querySelectorAll('input[type="number"]');
    inputs.forEach(function(i){
      var id = i.id;
      var maxVal = (id === 'y1' || id === 'y2' || id === 'cpd') ? 10 : 100;
      i.value = maxVal;
      i.classList.remove('error');
    });
    resetForm();
    calculateLPP();
  }

  window.addEventListener('DOMContentLoaded', resetToZero);
</script>

</body>
</html>