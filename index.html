<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LPP Calculator</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f2f4f8;
      color: #222;
    }

    .page {
      max-width: 1300px;
      margin: 20px auto;
      padding: 0 15px 30px;
    }

    .container {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 25px;
    }

    .left-column {
      flex: 1.3;
    }

    .right-column {
      flex: 1.7;
      text-align: right;
    }

    .card {
      background: #ffffff;
      border-radius: 10px;
      padding: 18px 20px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }

    h1 {
      margin-top: 0;
      margin-bottom: 0.4em;
      font-size: 1.6em;
    }

    .intro {
      font-size: 0.9em;
      color: #4b5563;
      margin-bottom: 10px;
    }

    fieldset {
      margin-bottom: 15px;
      padding: 10px 15px;
      border-radius: 6px;
      border: 1px solid #cbd5e1;
      background: #fff;
      border-left: 4px solid #2563eb;
    }

    legend {
      font-weight: bold;
      padding: 0 4px;
      font-size: 0.95em;
      text-transform: uppercase;
      color: #111827;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 120px;
      gap: 6px 10px;
      align-items: center;
      margin-bottom: 5px;
    }

    label {
      font-size: 0.95em;
    }

    input[type="number"] {
      width: 100%;
      padding: 4px;
      border-radius: 4px;
      border: 1px solid #bbb;
      font-size: 0.9em;
    }

    input[type="number"].error {
      border-color: #dc2626;
      background: #fef2f2;
    }

    .buttons {
      margin: 15px 0;
    }

    button {
      padding: 8px 16px;
      margin-right: 10px;
      cursor: pointer;
      border-radius: 4px;
      border: 1px solid #1f6feb;
      background: #2563eb;
      color: #fff;
      font-size: 0.95em;
    }

    button:nth-child(2) {
      background: #ffffff;
      color: #2563eb;
    }

    button:nth-child(3) {
      background: #10b981;
      border-color: #059669;
    }

    .results {
      background: #f9fafb;
      padding: 10px 15px;
      border-radius: 6px;
      border: 1px solid #e5e7eb;
      font-size: 0.95em;
      margin-top: 10px;
    }

    .results p {
      margin: 4px 0;
    }

    .highlight {
      font-weight: bold;
      font-size: 1.1em;
      margin-top: 8px;
    }

    .section-subtotal {
      font-weight: bold;
      margin-top: 8px;
      font-size: 0.95em;
      color: #1f2937;
    }

    .section-subtotal span.value {
      color: #2563eb;
    }

    .right-column img {
      width: 100%;
      height: auto;
      margin-bottom: 25px;
      border-radius: 8px;
      padding: 6px;
      background: #ffffff;
      box-shadow: 0 3px 12px rgba(0,0,0,0.12);
    }

    .right-column img.logo {
      width: 60%;
      max-width: 220px;
      margin-bottom: 20px;
    }

    .right-column h3 {
      margin: 0 0 6px;
      font-size: 0.95em;
      color: #111827;
    }

    @media (max-width: 900px) {
      .container {
        flex-direction: column;
      }
      .right-column {
        text-align: center;
      }
      .right-column h3 {
        text-align: center;
      }
    }
  </style>
</head>
<body>

<div class="page">

  <div class="container">

    <!-- LEFT CALCULATOR PANEL -->
    <div class="left-column">
      <div class="card">
        <h1>LPP Calculator</h1>
        <p>Please enter scores in the range of 0-100.</p>
        <ul class="intro">
          <li><strong>X1</strong>: Quantitative output (publications, grants, supervision, teaching)</li>
          <li><strong>X2</strong>: Quality of publications and grants</li>
          <li><strong>M3–M5</strong>: Leadership, consultancy, and service (best 2 of 3)</li>
          <li><strong>Y</strong>: Work output and impact (narrative)</li>
          <li><strong>Z</strong>: CPD activities</li>
        </ul>

        <!-- X1 -->
        <fieldset>
          <legend>X1 - Quantitative Component (max 60)</legend>
          <div class="grid">
            <label>X1: M1 Q1 and Q2 (C4)</label>
            <input id="x1_q1q2" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>X1: M1 Q1 to Q4 (C5)</label>
            <input id="x1_q1q4" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>X1: M1 Grants (C6)</label>
            <input id="x1_geran" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>X1: M2 Supervision (C7)</label>
            <input id="x1_penyeliaan" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>X1: M2 Teaching (C8)</label>
            <input id="x1_pengajaran" type="number" min="0" max="100" value="0" oninput="calculateLPP()">
          </div>
          <p class="section-subtotal" id="x1Subtotal">
            X1 subtotal: <span class="value">0.00</span> / 60
          </p>
        </fieldset>

        <!-- X2 -->
        <fieldset>
          <legend>X2 - Publication Quality and Grants (max 40)</legend>
          <div class="grid">
            <label>X2: Publication Quality 1 (C10)</label>
            <input id="x2_pub1" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>X2: Publication Quality 2 (C11)</label>
            <input id="x2_pub2" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>X2: Grant Quality (C12)</label>
            <input id="x2_geran" type="number" min="0" max="100" value="0" oninput="calculateLPP()">
          </div>
          <p class="section-subtotal" id="x2Subtotal">
            X2 subtotal: <span class="value">0.00</span> / 40
          </p>
        </fieldset>

        <!-- M3–M5 -->
        <fieldset>
          <legend>M3, M4, M5 - Qualitative Component (max 28)</legend>
          <div class="grid">
            <label>M3 - Academic Leadership</label>
            <input id="m3" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>M4 - Consultancy (if applicable)</label>
            <input id="m4" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>M5 - Service to University</label>
            <input id="m5" type="number" min="0" max="100" value="0" oninput="calculateLPP()">
          </div>
          <p class="section-subtotal" id="mSubtotal">
            M3-M5 subtotal (best 2): <span class="value">0.00</span> / 28
          </p>
        </fieldset>

        <!-- Y -->
        <fieldset>
          <legend>Y - Work Output and Impact (max 20)</legend>
          <div class="grid">
            <label>Y1 - Work Output</label>
            <input id="y1" type="number" min="0" max="100" value="0" oninput="calculateLPP()">

            <label>Y2 - Impact Narrative</label>
            <input id="y2" type="number" min="0" max="100" value="0" oninput="calculateLPP()">
          </div>
          <p class="section-subtotal" id="ySubtotal">
            Y subtotal: <span class="value">0.00</span> / 20
          </p>
        </fieldset>

        <!-- CPD -->
        <fieldset>
          <legend>Z - CPD (max 10)</legend>
          <div class="grid">
            <label>CPD Score</label>
            <input id="cpd" type="number" min="0" max="100" value="0" oninput="calculateLPP()">
          </div>
          <p class="section-subtotal" id="cpdSubtotal">
            CPD subtotal: <span class="value">0.00</span> / 10
          </p>
        </fieldset>

        <!-- Buttons -->
        <div class="buttons">
          <button onclick="calculateLPP()">Calculate</button>
          <button onclick="resetForm()">Clear outputs</button>
          <button onclick="resetToZero()">Reset inputs to zero</button>
        </div>

        <!-- Results -->
        <div class="results" id="results">
          <h3>Results</h3>
          <p id="x1Result"></p>
          <p id="x2Result"></p>
          <p id="comp42Result"></p>
          <p id="m3m4m5Result"></p>
          <p id="totalXResult"></p>
          <p id="y1y2Result"></p>
          <p id="cpdResult"></p>
          <p id="breakdownResult"></p>
          <p class="highlight" id="finalResult"></p>
        </div>

      </div>
    </div>

    <!-- RIGHT IMAGES -->
    <div class="right-column">
      <img src="logo.png" alt="Logo" class="logo">

      <h3>Publication Marks</h3>
      <img src="pub_table.png" alt="Publication Table" class="table-img">

      <h3>Grant Marks</h3>
      <img src="grant_table.png" alt="Grant Table" class="table-img">
    </div>

  </div>

</div>

<script>
  // Clamp value 0-100, mark error if user typed out of range
  function val(id) {
    var el = document.getElementById(id);
    var v = parseFloat(el.value);
    var outOfRange = false;

    if (isNaN(v)) v = 0;
    if (v < 0) { v = 0; outOfRange = true; }
    if (v > 100) { v = 100; outOfRange = true; }

    if (outOfRange) el.classList.add('error');
    else el.classList.remove('error');

    el.value = v;
    return v;
  }

  function ratingFromScore(score) {
    if (score >= 90) return 'Outstanding';
    if (score >= 80) return 'Excellent';
    if (score >= 70) return 'Good';
    if (score >= 60) return 'Satisfactory';
    return 'Needs Improvement';
  }

  function calculateLPP() {
    var r = function(x) { return x.toFixed(2); };

    // X1
    var C4 = val('x1_q1q2');
    var C5 = val('x1_q1q4');
    var C6 = val('x1_geran');
    var C7 = val('x1_penyeliaan');
    var C8 = val('x1_pengajaran');

    var sumX1 = C4 + C5 + C6 + C7 + C8;
    var x1Raw = (sumX1 / 500) * 60;
    var x1Avg = sumX1 / 5;

    document.getElementById('x1Subtotal').innerHTML =
      'X1 subtotal: <span class="value">' + r(x1Raw) + '</span> / 60';

    // X2
    var C10 = val('x2_pub1');
    var C11 = val('x2_pub2');
    var C12 = val('x2_geran');

    var x2Raw = ((((C10 + C11) / 200) + (C12 / 100)) / 2) * 40;

    document.getElementById('x2Subtotal').innerHTML =
      'X2 subtotal: <span class="value">' + r(x2Raw) + '</span> / 40';

    // Quantitative component (42%)
    var comp42 = ((x1Raw + x2Raw) / 100) * 42;

    // M3–M5 best 2 of 3
    var arr = [val('m3'), val('m4'), val('m5')];
    arr.sort(function(a, b) { return b - a; });
    var mBestAvg = (arr[0] + arr[1]) / 2;
    var mScore = (mBestAvg / 100) * 28;

    document.getElementById('mSubtotal').innerHTML =
      'M3-M5 subtotal (best 2): <span class="value">' + r(mScore) + '</span> / 28';

    // Total X (70%)
    var totalX = comp42 + mScore;

    // Y
    var yTotal = (val('y1') / 100) * 10 + (val('y2') / 100) * 10;

    document.getElementById('ySubtotal').innerHTML =
      'Y subtotal: <span class="value">' + r(yTotal) + '</span> / 20';

    // CPD
    var cpdScore = (val('cpd') / 100) * 10;

    document.getElementById('cpdSubtotal').innerHTML =
      'CPD subtotal: <span class="value">' + r(cpdScore) + '</span> / 10';

    // Final total
    var finalTotal = totalX + yTotal + cpdScore;
    var rating = ratingFromScore(finalTotal);

    // Detailed results
    document.getElementById('x1Result').textContent =
      'X1 = ' + r(x1Raw) + ' / 60 (average input = ' + r(x1Avg) + ')';

    document.getElementById('x2Result').textContent =
      'X2 = ' + r(x2Raw) + ' / 40';

    document.getElementById('comp42Result').textContent =
      'Quantitative Component (42%) = ' + r(comp42) + ' / 42';

    document.getElementById('m3m4m5Result').textContent =
      'M3-M5 (best 2 of 3) = ' + r(mScore) + ' / 28';

    document.getElementById('totalXResult').textContent =
      'Total X = ' + r(totalX) + ' / 70';

    document.getElementById('y1y2Result').textContent =
      'Y1 + Y2 = ' + r(yTotal) + ' / 20';

    document.getElementById('cpdResult').textContent =
      'CPD = ' + r(cpdScore) + ' / 10';

    document.getElementById('breakdownResult').textContent =
      'Contribution: X = ' + r(totalX) +
      ', Y = ' + r(yTotal) +
      ', Z = ' + r(cpdScore) +
      ' (sum = ' + r(finalTotal) + ')';

    document.getElementById('finalResult').textContent =
      'FINAL LPP SCORE = ' + r(finalTotal) + ' / 100 (' + rating + ')';
  }

  function resetForm() {
    var ps = document.getElementById('results').querySelectorAll('p');
    ps.forEach(function(p) { p.textContent = ''; });

    document.getElementById('x1Subtotal').innerHTML =
      'X1 subtotal: <span class="value">0.00</span> / 60';
    document.getElementById('x2Subtotal').innerHTML =
      'X2 subtotal: <span class="value">0.00</span> / 40';
    document.getElementById('mSubtotal').innerHTML =
      'M3-M5 subtotal (best 2): <span class="value">0.00</span> / 28';
    document.getElementById('ySubtotal').innerHTML =
      'Y subtotal: <span class="value">0.00</span> / 20';
    document.getElementById('cpdSubtotal').innerHTML =
      'CPD subtotal: <span class="value">0.00</span> / 10';
  }

  function resetToZero() {
    var inputs = document.querySelectorAll('input[type="number"]');
    inputs.forEach(function(i) { i.value = 0; i.classList.remove('error'); });
    resetForm();
    calculateLPP();
  }

  // Initialize once on load so subtotals and results panel are consistent
  window.addEventListener('DOMContentLoaded', function() {
    resetToZero();
  });
</script>

</body>
</html>